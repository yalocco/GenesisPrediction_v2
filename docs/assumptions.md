# Assumptions & Design Decisions

本ドキュメントは、GenesisPrediction_v2 において
**意図的に採用している前提条件（Assumptions）と、
採用していない設計判断（Non-goals）**を明文化するものである。

この内容は、将来の改修・レビュー・AIによる設計支援において、
「なぜこの構成なのか」を判断する基準として使用する。

---

## 1. 時系列・実行モデルに関する前提

### 前提
- 本プロジェクトは **日次バッチ処理（daily batch）** を前提とする。
- リアルタイム処理やストリーミング処理は行わない。

### 理由
- 世界情勢・出来事・市場変化は「即時性」よりも
  **日次単位での意味づけ・差分把握**が重要である。
- リアルタイム化は設計・運用・監視コストを大きく増やす一方、
  予測精度の向上効果が限定的である。

### Non-goal
- Kafka / Kinesis 等を用いた常時ストリーミング処理
- 秒〜分単位での即時予測更新

---

## 2. データ完全性と遅延許容に関する前提

### 前提
- データの **完全性（correctness）を遅延より優先**する。
- 一時的な API 障害や取得遅延は許容する。

### 理由
- 欠損データや不整合は downstream（analysis / prediction）に
  長期的な悪影響を与える。
- 数分〜数十分の遅延よりも、
  **再実行可能で正しいデータ生成**を重視する。

### Non-goal
- 欠損を許容したままの強制続行
- 成功を装う partial failure の黙殺

---

## 3. 冪等性（Idempotency）を前提とした設計

### 前提
- すべての主要ステップ（fetcher / analyzer / scripts）は
  **冪等であること**を前提とする。
- 同一日付・同一入力で再実行しても結果は変わらない。

### 理由
- 障害復旧・再実行・dry-run を安全に行うため。
- Airflow / GitHub Actions からの手動再実行を容易にするため。

### Non-goal
- 実行回数に依存した副作用的処理
- 再実行不可な一発勝負の処理

---

## 4. スケール戦略に関する前提

### 前提
- 水平方向スケールよりも **設計の明確さと運用容易性**を優先する。
- 単一ノード / 単一リージョンでの運用を基本とする。

### 理由
- 現状の処理量では分散基盤は過剰。
- スケールアウトは「必要になったら検討する」段階的判断とする。

### Non-goal
- 初期段階からのマルチリージョン冗長化
- 自動スケーリング前提の設計

---

## 5. モデル・予測に関する前提

### 前提
- 予測結果は **意思決定支援の材料**であり、絶対的な正解ではない。
- モデル精度よりも **再現性・解釈可能性**を重視する。

### 理由
- ブラックボックス化した高精度モデルは、
  異常時の原因分析や改善が困難になる。
- diff / analysis と組み合わせた「意味づけ」が本プロジェクトの核である。

### Non-goal
- 精度のみを目的とした過度な複雑化
- 説明不能な end-to-end モデル

---

## 6. 運用・監視に関する前提

### 前提
- 障害は「起きるもの」として扱い、
  **早期検知・最小復旧**を目的とする。
- 完全無停止は目標としない。

### 理由
- 外部 API・ネットワーク・クラウド依存が存在する以上、
  障害ゼロは非現実的。
- Runbook による迅速な復旧の方が全体最適である。

### Non-goal
- 障害を完全に隠蔽する設計
- 複雑な自動復旧ロジックの多重実装

---

## 7. このドキュメントの使い方

- 新しい提案・改善案が出た場合は、
  **本 Assumptions に反していないか**を必ず確認する。
- 本前提を覆す場合は、
  fragile_points.md および Runbook の見直しを同時に行う。

本ドキュメントは、
GenesisPrediction_v2 の設計思想を将来に引き継ぐための
「判断基準」として維持される。
